{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport React, { useEffect, useState } from \"react\";\nimport InputForm from \"../Components/InputForm\";\nimport SubmitButton from \"../Components/SubmitButton\";\nimport { colors } from \"../Global/Colors\";\nimport { useSignInMutation } from \"../Services/authServices\";\nimport { isAtLeastSixCharacters, isValidEmail, isValidSign } from \"../Validations/auth\";\nimport { useDispatch } from \"react-redux\";\nimport { setUser } from \"../features/User/userSlice\";\nimport { insertSession } from \"../SQLite\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar LoginScreen = function LoginScreen(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    email = _useState2[0],\n    setEmail = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    password = _useState4[0],\n    setPassword = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    correct = _useState6[0],\n    setCorrect = _useState6[1];\n  var _useState7 = useState(''),\n    _useState8 = _slicedToArray(_useState7, 2),\n    errorEmail = _useState8[0],\n    setErrorEmail = _useState8[1];\n  var _useState9 = useState(''),\n    _useState10 = _slicedToArray(_useState9, 2),\n    errorPassword = _useState10[0],\n    setErrorPassword = _useState10[1];\n  var dispatch = useDispatch();\n  var _useSignInMutation = useSignInMutation(),\n    _useSignInMutation2 = _slicedToArray(_useSignInMutation, 2),\n    triggerSignIn = _useSignInMutation2[0],\n    resultSignIn = _useSignInMutation2[1];\n  var onSubmit = function onSubmit() {\n    var isValidVariableEmail = isValidEmail(email);\n    var isCorrectPassword = isAtLeastSixCharacters(password);\n    if (isValidVariableEmail && isCorrectPassword) {\n      triggerSignIn({\n        email: email,\n        password: password,\n        returnSecureToken: true\n      });\n      setTimeout(function () {\n        if (!resultSignIn.data.email) {\n          alert(\"EMAIL o CONTRASEÑA INCORRECTA\");\n        }\n      }, 1000);\n    }\n    if (!isValidVariableEmail) setErrorEmail('Email is not correct');else setErrorEmail('');\n    if (!isCorrectPassword) setErrorPassword('Password must be at least 6 characters');else setErrorPassword('');\n  };\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      try {\n        if (resultSignIn.isSuccess) {\n          setCorrect(true);\n          console.log('inserting Session');\n          var response = yield insertSession({\n            email: resultSignIn.data.email,\n            idToken: resultSignIn.data.idToken,\n            localId: resultSignIn.data.localId\n          });\n          console.log('Session inserted: ');\n          console.log(response);\n          dispatch(setUser({\n            email: resultSignIn.data.email,\n            idToken: resultSignIn.data.idToken,\n            localId: resultSignIn.data.localId,\n            profileImage: \"\",\n            location: {\n              latitude: \"\",\n              longitude: \"\"\n            }\n          }));\n        }\n      } catch (error) {\n        console.log(error.message);\n      }\n    })();\n  }, [resultSignIn]);\n  return _jsx(View, {\n    style: styles.main,\n    children: _jsxs(View, {\n      style: styles.container,\n      children: [_jsx(Text, {\n        style: styles.title,\n        children: \"Ingresa\"\n      }), _jsx(InputForm, {\n        label: \"email\",\n        onChange: function onChange(email) {\n          return setEmail(email);\n        },\n        error: errorEmail\n      }), _jsx(InputForm, {\n        label: \"password\",\n        onChange: function onChange(password) {\n          return setPassword(password);\n        },\n        error: errorPassword,\n        isSecure: true\n      }), _jsx(SubmitButton, {\n        onPress: onSubmit,\n        title: \"Entrar\"\n      }), _jsx(Text, {\n        style: styles.sub,\n        children: \"No tenes cuenta aun ?\"\n      }), _jsx(Pressable, {\n        onPress: function onPress() {\n          return navigation.navigate(\"Signup\");\n        },\n        children: _jsx(Text, {\n          style: styles.subLink,\n          children: \"Registrate por 1era vez\"\n        })\n      })]\n    })\n  });\n};\nexport default LoginScreen;\nvar styles = StyleSheet.create({\n  main: {\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  container: {\n    width: \"90%\",\n    flexDirection: \"column\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: colors.lightPink,\n    gap: 15,\n    paddingVertical: 20,\n    borderRadius: 10\n  },\n  title: {\n    fontSize: 22,\n    fontFamily: \"Josefin\"\n  },\n  sub: {\n    fontSize: 14,\n    color: \"black\"\n  },\n  subLink: {\n    fontSize: 14,\n    color: \"blue\"\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","InputForm","SubmitButton","colors","useSignInMutation","isAtLeastSixCharacters","isValidEmail","isValidSign","useDispatch","setUser","insertSession","jsx","_jsx","jsxs","_jsxs","LoginScreen","_ref","navigation","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","_useState6","correct","setCorrect","_useState7","_useState8","errorEmail","setErrorEmail","_useState9","_useState10","errorPassword","setErrorPassword","dispatch","_useSignInMutation","_useSignInMutation2","triggerSignIn","resultSignIn","onSubmit","isValidVariableEmail","isCorrectPassword","returnSecureToken","setTimeout","data","alert","_asyncToGenerator","isSuccess","console","log","response","idToken","localId","profileImage","location","latitude","longitude","error","message","View","style","styles","main","children","container","Text","title","label","onChange","isSecure","onPress","sub","Pressable","navigate","subLink","StyleSheet","create","width","height","justifyContent","alignItems","flexDirection","backgroundColor","lightPink","gap","paddingVertical","borderRadius","fontSize","fontFamily","color"],"sources":["C:/Users/federico.currao/Desktop/OtrosFC/mycar/Where-Is-My-Car---App-Android/src/Screens/LoginScreen.jsx"],"sourcesContent":["import { Pressable, StyleSheet, Text, View } from \"react-native\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport InputForm from \"../Components/InputForm\";\r\nimport SubmitButton from \"../Components/SubmitButton\";\r\nimport { colors } from \"../Global/Colors\";\r\nimport { useSignInMutation } from \"../Services/authServices\";\r\nimport { isAtLeastSixCharacters, isValidEmail , isValidSign} from \"../Validations/auth\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { setUser } from \"../features/User/userSlice\";\r\nimport { insertSession } from \"../SQLite\";\r\n\r\nconst LoginScreen = ({ navigation }) => {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [correct, setCorrect] = useState(false);\r\n\r\n    const [errorEmail, setErrorEmail] = useState('')\r\n    const [errorPassword, setErrorPassword] = useState('')\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const [triggerSignIn, resultSignIn] = useSignInMutation();\r\n    const onSubmit = () => {\r\n\r\n        //Submit logic with validations\r\n        const isValidVariableEmail = isValidEmail(email)\r\n        const isCorrectPassword = isAtLeastSixCharacters(password) \r\n\r\n        if (isValidVariableEmail && isCorrectPassword) {\r\n                \r\n                  \r\n            \r\n\r\n\r\n            triggerSignIn({\r\n                email,\r\n                password,\r\n                returnSecureToken: true,\r\n            });\r\n\r\n            \r\n            setTimeout(() => {\r\n                    if(!resultSignIn.data.email) {\r\n                    alert(\"EMAIL o CONTRASEÑA INCORRECTA\") \r\n                    // (resultSignIn == undefined || (resultSignIn != undefined && resultSignIn.status == \"uninitialized\") || (resultSignIn != undefined && resultSignIn.status == \"rejected\") ) ? alert(\"EMAIL o CONTRASEÑA INCORRECTA\") : \"\";\r\n                }\r\n            }, 1000);\r\n\r\n\r\n        }\r\n\r\n        if (!isValidVariableEmail) setErrorEmail ('Email is not correct')\r\n        else setErrorEmail('')\r\n        if (!isCorrectPassword) setErrorPassword ('Password must be at least 6 characters')\r\n        else setErrorPassword('') \r\n       \r\n    };\r\n    \r\n    useEffect(()=> {\r\n        (async ()=> {\r\n            try {\r\n                if(resultSignIn.isSuccess) {\r\n                    setCorrect(true)\r\n                    //Insert session in SQLite database\r\n                      console.log('inserting Session');\r\n                    const response = await insertSession({\r\n                        email: resultSignIn.data.email,\r\n                        idToken: resultSignIn.data.idToken,\r\n                        localId: resultSignIn.data.localId,\r\n                    })\r\n                    console.log('Session inserted: ');\r\n                    console.log(response);  \r\n                    dispatch(setUser({\r\n                        email: resultSignIn.data.email,\r\n                        idToken: resultSignIn.data.idToken,\r\n                        localId: resultSignIn.data.localId,\r\n                        profileImage: \"\",\r\n                        location: {\r\n                            latitude: \"\",\r\n                            longitude: \"\",\r\n                        }\r\n                    }))\r\n                } \r\n            } catch (error) {\r\n                console.log(error.message);\r\n            }\r\n        })()\r\n    }, [resultSignIn])\r\n\r\n    return (\r\n        <View style={styles.main}>\r\n            <View style={styles.container}>\r\n                <Text style={styles.title}>Ingresa</Text>\r\n                <InputForm\r\n                    label={\"email\"}\r\n                    onChange={(email) => setEmail(email)}\r\n                    error={errorEmail}\r\n                />\r\n                <InputForm\r\n                    label={\"password\"}\r\n                    onChange={(password) => setPassword(password)}\r\n                    error={errorPassword}\r\n                    isSecure={true}\r\n                />\r\n                <SubmitButton onPress={onSubmit} title=\"Entrar\" />\r\n                <Text style={styles.sub}>No tenes cuenta aun ?</Text>\r\n                <Pressable onPress={() => navigation.navigate(\"Signup\")}>\r\n                    <Text style={styles.subLink}>Registrate por 1era vez</Text>\r\n                </Pressable>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nexport default LoginScreen;\r\n\r\nconst styles = StyleSheet.create({\r\n    main: {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    },\r\n    container: {\r\n        width: \"90%\",\r\n        flexDirection: \"column\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        backgroundColor: colors.lightPink,\r\n        gap: 15,\r\n        paddingVertical: 20,\r\n        borderRadius: 10,\r\n    },\r\n    title: {\r\n        fontSize: 22,\r\n        fontFamily: \"Josefin\",\r\n    },\r\n    sub: {\r\n        fontSize: 14,\r\n        color: \"black\",\r\n    },\r\n    subLink: {\r\n        fontSize: 14,\r\n        color: \"blue\",\r\n    },\r\n});"],"mappings":";;;;;;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,SAAS;AAChB,OAAOC,YAAY;AACnB,SAASC,MAAM;AACf,SAASC,iBAAiB;AAC1B,SAASC,sBAAsB,EAAEC,YAAY,EAAGC,WAAW;AAC3D,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,OAAO;AAChB,SAASC,aAAa;AAAoB,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAE1C,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAAC,IAAA,EAAuB;EAAA,IAAjBC,UAAU,GAAAD,IAAA,CAAVC,UAAU;EAC7B,IAAAC,SAAA,GAA0BlB,QAAQ,CAAC,EAAE,CAAC;IAAAmB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA/BG,KAAK,GAAAF,UAAA;IAAEG,QAAQ,GAAAH,UAAA;EACtB,IAAAI,UAAA,GAAgCvB,QAAQ,CAAC,EAAE,CAAC;IAAAwB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAArCE,QAAQ,GAAAD,UAAA;IAAEE,WAAW,GAAAF,UAAA;EAC5B,IAAAG,UAAA,GAA8B3B,QAAQ,CAAC,KAAK,CAAC;IAAA4B,UAAA,GAAAR,cAAA,CAAAO,UAAA;IAAtCE,OAAO,GAAAD,UAAA;IAAEE,UAAU,GAAAF,UAAA;EAE1B,IAAAG,UAAA,GAAoC/B,QAAQ,CAAC,EAAE,CAAC;IAAAgC,UAAA,GAAAZ,cAAA,CAAAW,UAAA;IAAzCE,UAAU,GAAAD,UAAA;IAAEE,aAAa,GAAAF,UAAA;EAChC,IAAAG,UAAA,GAA0CnC,QAAQ,CAAC,EAAE,CAAC;IAAAoC,WAAA,GAAAhB,cAAA,CAAAe,UAAA;IAA/CE,aAAa,GAAAD,WAAA;IAAEE,gBAAgB,GAAAF,WAAA;EAEtC,IAAMG,QAAQ,GAAG/B,WAAW,CAAC,CAAC;EAE9B,IAAAgC,kBAAA,GAAsCpC,iBAAiB,CAAC,CAAC;IAAAqC,mBAAA,GAAArB,cAAA,CAAAoB,kBAAA;IAAlDE,aAAa,GAAAD,mBAAA;IAAEE,YAAY,GAAAF,mBAAA;EAClC,IAAMG,QAAQ,GAAG,SAAXA,QAAQA,CAAA,EAAS;IAGnB,IAAMC,oBAAoB,GAAGvC,YAAY,CAACe,KAAK,CAAC;IAChD,IAAMyB,iBAAiB,GAAGzC,sBAAsB,CAACoB,QAAQ,CAAC;IAE1D,IAAIoB,oBAAoB,IAAIC,iBAAiB,EAAE;MAM3CJ,aAAa,CAAC;QACVrB,KAAK,EAALA,KAAK;QACLI,QAAQ,EAARA,QAAQ;QACRsB,iBAAiB,EAAE;MACvB,CAAC,CAAC;MAGFC,UAAU,CAAC,YAAM;QACT,IAAG,CAACL,YAAY,CAACM,IAAI,CAAC5B,KAAK,EAAE;UAC7B6B,KAAK,CAAC,+BAA+B,CAAC;QAE1C;MACJ,CAAC,EAAE,IAAI,CAAC;IAGZ;IAEA,IAAI,CAACL,oBAAoB,EAAEX,aAAa,CAAE,sBAAsB,CAAC,MAC5DA,aAAa,CAAC,EAAE,CAAC;IACtB,IAAI,CAACY,iBAAiB,EAAER,gBAAgB,CAAE,wCAAwC,CAAC,MAC9EA,gBAAgB,CAAC,EAAE,CAAC;EAE7B,CAAC;EAEDvC,SAAS,CAAC,YAAK;IACXoD,iBAAA,CAAC,aAAW;MACR,IAAI;QACA,IAAGR,YAAY,CAACS,SAAS,EAAE;UACvBtB,UAAU,CAAC,IAAI,CAAC;UAEduB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;UAClC,IAAMC,QAAQ,SAAS7C,aAAa,CAAC;YACjCW,KAAK,EAAEsB,YAAY,CAACM,IAAI,CAAC5B,KAAK;YAC9BmC,OAAO,EAAEb,YAAY,CAACM,IAAI,CAACO,OAAO;YAClCC,OAAO,EAAEd,YAAY,CAACM,IAAI,CAACQ;UAC/B,CAAC,CAAC;UACFJ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;UACjCD,OAAO,CAACC,GAAG,CAACC,QAAQ,CAAC;UACrBhB,QAAQ,CAAC9B,OAAO,CAAC;YACbY,KAAK,EAAEsB,YAAY,CAACM,IAAI,CAAC5B,KAAK;YAC9BmC,OAAO,EAAEb,YAAY,CAACM,IAAI,CAACO,OAAO;YAClCC,OAAO,EAAEd,YAAY,CAACM,IAAI,CAACQ,OAAO;YAClCC,YAAY,EAAE,EAAE;YAChBC,QAAQ,EAAE;cACNC,QAAQ,EAAE,EAAE;cACZC,SAAS,EAAE;YACf;UACJ,CAAC,CAAC,CAAC;QACP;MACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;QACZT,OAAO,CAACC,GAAG,CAACQ,KAAK,CAACC,OAAO,CAAC;MAC9B;IACJ,CAAC,EAAE,CAAC;EACR,CAAC,EAAE,CAACpB,YAAY,CAAC,CAAC;EAElB,OACI/B,IAAA,CAACoD,IAAI;IAACC,KAAK,EAAEC,MAAM,CAACC,IAAK;IAAAC,QAAA,EACrBtD,KAAA,CAACkD,IAAI;MAACC,KAAK,EAAEC,MAAM,CAACG,SAAU;MAAAD,QAAA,GAC1BxD,IAAA,CAAC0D,IAAI;QAACL,KAAK,EAAEC,MAAM,CAACK,KAAM;QAAAH,QAAA,EAAC;MAAO,CAAM,CAAC,EACzCxD,IAAA,CAACX,SAAS;QACNuE,KAAK,EAAE,OAAQ;QACfC,QAAQ,EAAE,SAAAA,SAACpD,KAAK;UAAA,OAAKC,QAAQ,CAACD,KAAK,CAAC;QAAA,CAAC;QACrCyC,KAAK,EAAE7B;MAAW,CACrB,CAAC,EACFrB,IAAA,CAACX,SAAS;QACNuE,KAAK,EAAE,UAAW;QAClBC,QAAQ,EAAE,SAAAA,SAAChD,QAAQ;UAAA,OAAKC,WAAW,CAACD,QAAQ,CAAC;QAAA,CAAC;QAC9CqC,KAAK,EAAEzB,aAAc;QACrBqC,QAAQ,EAAE;MAAK,CAClB,CAAC,EACF9D,IAAA,CAACV,YAAY;QAACyE,OAAO,EAAE/B,QAAS;QAAC2B,KAAK,EAAC;MAAQ,CAAE,CAAC,EAClD3D,IAAA,CAAC0D,IAAI;QAACL,KAAK,EAAEC,MAAM,CAACU,GAAI;QAAAR,QAAA,EAAC;MAAqB,CAAM,CAAC,EACrDxD,IAAA,CAACiE,SAAS;QAACF,OAAO,EAAE,SAAAA,QAAA;UAAA,OAAM1D,UAAU,CAAC6D,QAAQ,CAAC,QAAQ,CAAC;QAAA,CAAC;QAAAV,QAAA,EACpDxD,IAAA,CAAC0D,IAAI;UAACL,KAAK,EAAEC,MAAM,CAACa,OAAQ;UAAAX,QAAA,EAAC;QAAuB,CAAM;MAAC,CACpD,CAAC;IAAA,CACV;EAAC,CACL,CAAC;AAEf,CAAC;AAED,eAAerD,WAAW;AAE1B,IAAMmD,MAAM,GAAGc,UAAU,CAACC,MAAM,CAAC;EAC7Bd,IAAI,EAAE;IACFe,KAAK,EAAE,MAAM;IACbC,MAAM,EAAE,MAAM;IACdC,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE;EAChB,CAAC;EACDhB,SAAS,EAAE;IACPa,KAAK,EAAE,KAAK;IACZI,aAAa,EAAE,QAAQ;IACvBF,cAAc,EAAE,QAAQ;IACxBC,UAAU,EAAE,QAAQ;IACpBE,eAAe,EAAEpF,MAAM,CAACqF,SAAS;IACjCC,GAAG,EAAE,EAAE;IACPC,eAAe,EAAE,EAAE;IACnBC,YAAY,EAAE;EAClB,CAAC;EACDpB,KAAK,EAAE;IACHqB,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE;EAChB,CAAC;EACDjB,GAAG,EAAE;IACDgB,QAAQ,EAAE,EAAE;IACZE,KAAK,EAAE;EACX,CAAC;EACDf,OAAO,EAAE;IACLa,QAAQ,EAAE,EAAE;IACZE,KAAK,EAAE;EACX;AACJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}