{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from \"react\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport AddButton from \"../Components/AddButton\";\nimport { colors } from \"../Global/Colors\";\nimport * as MediaLibrary from 'expo-media-library';\nimport * as ImagePicker from 'expo-image-picker';\nimport { usePostProfileImageMutation } from \"../Services/shopServices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveImage } from \"../features/User/userSlice\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ImageSelector = function ImageSelector(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    image = _useState2[0],\n    setImage = _useState2[1];\n  var _usePostProfileImageM = usePostProfileImageMutation(),\n    _usePostProfileImageM2 = _slicedToArray(_usePostProfileImageM, 2),\n    triggerSaveImage = _usePostProfileImageM2[0],\n    resultSaveImage = _usePostProfileImageM2[1];\n  var dispatch = useDispatch();\n  var _useSelector = useSelector(function (state) {\n      return state.userReducer.value;\n    }),\n    localId = _useSelector.localId;\n  var verifyCameraPermissions = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var _yield$ImagePicker$re = yield ImagePicker.requestCameraPermissionsAsync(),\n        granted = _yield$ImagePicker$re.granted;\n      if (!granted) {\n        return false;\n      }\n      return true;\n    });\n    return function verifyCameraPermissions() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var pickImage = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var isCameraOk = yield verifyCameraPermissions();\n      if (isCameraOk) {\n        var result = yield ImagePicker.launchCameraAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.All,\n          allowsEditing: true,\n          aspect: [1, 1],\n          quality: 1\n        });\n        console.log(result.assets);\n        if (!result.canceled) {\n          setImage(result.assets[0].uri);\n        }\n      }\n    });\n    return function pickImage() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var confirmImage = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      alert(\"foto cambiada\");\n      try {\n        var _yield$MediaLibrary$r = yield MediaLibrary.requestPermissionsAsync(),\n          status = _yield$MediaLibrary$r.status;\n        console.log(\"STATUSSSS\", status);\n        if (status === \"granted\") {\n          console.log(\"Only valid on emulators and physical devices\");\n          var response = yield MediaLibrary.createAssetAsync(image);\n          console.log(\"URI ????\", response.uri);\n          triggerSaveImage({\n            image: response.uri,\n            localId: localId\n          });\n          dispatch(saveImage(response.uri));\n        }\n      } catch (error) {\n        console.log(error);\n      }\n      navigation.goBack();\n    });\n    return function confirmImage() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  return _jsx(View, {\n    style: styles.container,\n    children: image ? _jsxs(_Fragment, {\n      children: [_jsx(Image, {\n        source: {\n          uri: image\n        },\n        style: styles.image\n      }), _jsx(AddButton, {\n        title: \"Take another photo\",\n        onPress: pickImage\n      }), _jsx(AddButton, {\n        title: \"Confirm photo\",\n        onPress: confirmImage\n      })]\n    }) : _jsxs(_Fragment, {\n      children: [_jsx(View, {\n        style: styles.noPhotoContainer,\n        children: _jsx(Text, {\n          children: \"No photo to show...\"\n        })\n      }), _jsx(AddButton, {\n        title: \"Take a photo\",\n        onPress: pickImage\n      })]\n    })\n  });\n};\nexport default ImageSelector;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n    gap: 20,\n    marginTop: 20\n  },\n  image: {\n    width: 200,\n    height: 200\n  },\n  noPhotoContainer: {\n    width: 200,\n    height: 200,\n    borderWidth: 2,\n    borderColor: colors.red,\n    padding: 10,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"names":["React","useState","Image","View","StyleSheet","Text","AddButton","colors","MediaLibrary","ImagePicker","usePostProfileImageMutation","useDispatch","useSelector","saveImage","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ImageSelector","_ref","navigation","_useState","_useState2","_slicedToArray","image","setImage","_usePostProfileImageM","_usePostProfileImageM2","triggerSaveImage","resultSaveImage","dispatch","_useSelector","state","userReducer","value","localId","verifyCameraPermissions","_ref2","_asyncToGenerator","_yield$ImagePicker$re","requestCameraPermissionsAsync","granted","apply","arguments","pickImage","_ref3","isCameraOk","result","launchCameraAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","console","log","assets","canceled","uri","confirmImage","_ref4","alert","_yield$MediaLibrary$r","requestPermissionsAsync","status","response","createAssetAsync","error","goBack","style","styles","container","children","source","title","onPress","noPhotoContainer","create","flex","alignItems","justifyContent","gap","marginTop","width","height","borderWidth","borderColor","red","padding"],"sources":["C:/Users/federico.currao/Desktop/OtrosFC/mycar/Where-Is-My-Car---App-Android/src/Screens/ImageSelector.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Image, View, StyleSheet, Text } from \"react-native\";\r\nimport AddButton from \"../Components/AddButton\";\r\nimport { colors } from \"../Global/Colors\";\r\nimport * as MediaLibrary from 'expo-media-library'\r\nimport * as ImagePicker from 'expo-image-picker'\r\nimport { usePostProfileImageMutation } from \"../Services/shopServices\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { saveImage } from \"../features/User/userSlice\";\r\n\r\nconst ImageSelector = ({ navigation }) => {\r\n    const [image, setImage] = useState(null);\r\n\r\n    const [triggerSaveImage, resultSaveImage] = usePostProfileImageMutation();\r\n    const dispatch = useDispatch();\r\n    const { localId } = useSelector((state) => state.userReducer.value);\r\n\r\n    const verifyCameraPermissions = async () => {\r\n        const { granted } = await ImagePicker.requestCameraPermissionsAsync();\r\n        if (!granted) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const pickImage = async () => {\r\n\r\n        //Permission for camera\r\n        const isCameraOk = await verifyCameraPermissions();\r\n\r\n        if (isCameraOk) {\r\n            // No permissions request is necessary for launching the image library\r\n            let result = await ImagePicker.launchCameraAsync({\r\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\r\n                allowsEditing: true,\r\n                aspect: [1, 1],\r\n                //base64: true,\r\n                quality: 1,\r\n            });\r\n\r\n            console.log(result.assets);\r\n\r\n            if (!result.canceled) {\r\n                setImage(result.assets[0].uri);\r\n            }\r\n        }\r\n    };\r\n\r\n    const confirmImage = async () => {\r\n        alert(\"foto cambiada\")\r\n        // SI ES EN WEB, PARA PROBAR, DEJO ESTAS DOS LINEAS Y COMENTO TODO EL TRY ,CATCH\r\n        // dispatch(saveImage(image))\r\n        // navigation.goBack()\r\n        // SI NO ESTOY PROBANDO, PARA CELU, DEJAR ESTO: (TRY,CATCH)\r\n        try {\r\n            // Request device storage access permission\r\n            const { status } = await MediaLibrary.requestPermissionsAsync();  \r\n            console.log(\"STATUSSSS\", status);\r\n            if (status === \"granted\") {\r\n                console.log(\"Only valid on emulators and physical devices\");\r\n                // Save image to media library and create an asset\r\n                const response = await MediaLibrary.createAssetAsync(image);\r\n                console.log(\"URI ????\",response.uri);\r\n                //Save image link on profileImages remote location\r\n                triggerSaveImage({\r\n                    image: response.uri,\r\n                    localId: localId,\r\n                });\r\n                // Set image on redux state\r\n                dispatch(saveImage(response.uri));\r\n            }\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n        navigation.goBack();\r\n    };\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            {image ? (\r\n                <>\r\n                    <Image source={{ uri: image }} style={styles.image} />\r\n                    <AddButton title=\"Take another photo\" onPress={pickImage} />\r\n                    <AddButton title=\"Confirm photo\" onPress={confirmImage} />\r\n                </>\r\n            ) : (\r\n                <>\r\n                    <View style={styles.noPhotoContainer}>\r\n                        <Text>No photo to show...</Text>\r\n                    </View>\r\n                    <AddButton title=\"Take a photo\" onPress={pickImage} />\r\n                </>\r\n            )}\r\n        </View>\r\n    );\r\n};\r\n\r\nexport default ImageSelector;\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        alignItems: \"center\",\r\n        justifyContent: \"flex-start\",\r\n        gap: 20,\r\n        marginTop: 20,\r\n    },\r\n    image: {\r\n        width: 200,\r\n        height: 200,\r\n    },\r\n    noPhotoContainer: {\r\n        width: 200,\r\n        height: 200,\r\n        borderWidth: 2,\r\n        borderColor: colors.red,\r\n        padding: 10,\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    },\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}