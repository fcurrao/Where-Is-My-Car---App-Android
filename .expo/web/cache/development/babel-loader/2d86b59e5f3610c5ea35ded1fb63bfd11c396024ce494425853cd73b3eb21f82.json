{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport React, { useEffect, useState } from \"react\";\nimport * as Location from \"expo-location\";\nimport AddButton from \"../Components/AddButton\";\nimport { usePostUserLocationMutation } from \"../Services/shopServices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { setUserLocation } from \"../features/User/userSlice\";\nimport { colors } from \"../Global/Colors\";\nimport MapPreview from \"../Components/MapPreview\";\nimport { google_maps_api_key } from \"../Database/firebaseConfig\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar LocationSelector = function LocationSelector(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState({\n      latitude: \"\",\n      longitude: \"\"\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    location = _useState2[0],\n    setLocation = _useState2[1];\n  var _useState3 = useState(\"\"),\n    _useState4 = _slicedToArray(_useState3, 2),\n    error = _useState4[0],\n    setError = _useState4[1];\n  var _useState5 = useState(\"\"),\n    _useState6 = _slicedToArray(_useState5, 2),\n    inputtextoa = _useState6[0],\n    setInputtextoa = _useState6[1];\n  var _useState7 = useState(\"\"),\n    _useState8 = _slicedToArray(_useState7, 2),\n    inputtextob = _useState8[0],\n    setInputtextob = _useState8[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    address = _useState10[0],\n    setAddress = _useState10[1];\n  var _useSelector = useSelector(function (state) {\n      return state.userReducer.value;\n    }),\n    localId = _useSelector.localId;\n  var _usePostUserLocationM = usePostUserLocationMutation(),\n    _usePostUserLocationM2 = _slicedToArray(_usePostUserLocationM, 2),\n    triggerPostAddress = _usePostUserLocationM2[0],\n    result = _usePostUserLocationM2[1];\n  var dispatch = useDispatch();\n  var onConfirmAddress = function onConfirmAddress() {\n    alert(\"Direccion cambiada\");\n    var locationFormatted = {\n      latitude: location.latitude,\n      longitude: location.longitude,\n      address: address,\n      inputa: inputtextoa,\n      inputb: inputtextob\n    };\n    console.log(\"location\", locationFormatted);\n    dispatch(setUserLocation(locationFormatted));\n    triggerPostAddress({\n      location: locationFormatted,\n      localId: localId\n    });\n    navigation.goBack();\n  };\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      try {\n        var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          status = _yield$Location$reque.status;\n        if (status !== \"granted\") {\n          setError(\"Permission to access location was denied\");\n          return;\n        }\n        var _location = yield Location.getCurrentPositionAsync({});\n        setLocation({\n          latitude: _location.coords.latitude,\n          longitude: _location.coords.longitude\n        });\n      } catch (error) {\n        console.log(error.message);\n        setError(error.message);\n      }\n    })();\n  }, []);\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      try {\n        if (location.latitude) {\n          var url_reverse_geocode = \"https://maps.googleapis.com/maps/api/geocode/json?latlng=\" + location.latitude + \",\" + location.longitude + \"&key=\" + google_maps_api_key;\n          var response = yield fetch(url_reverse_geocode);\n          var data = yield response.json();\n          setAddress(data.results[0].formatted_address);\n        }\n      } catch (error) {\n        setError(error.message);\n      }\n    })();\n  }, [location]);\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Text, {\n      style: styles.text,\n      children: \"My Address\"\n    }), location ? _jsxs(_Fragment, {\n      children: [_jsxs(Text, {\n        style: styles.text,\n        children: [\"Lat: \", location.latitude, \", long: \", location.longitude, \".\"]\n      }), _jsx(MapPreview, {\n        location: location\n      }), _jsxs(Text, {\n        style: styles.address,\n        children: [\"Adress: \", address]\n      }), _jsx(TextInput, {\n        style: styles.address,\n        value: inputtextoa,\n        placeholder: \"comentario 1\",\n        keyboardType: \"numeric\"\n      }), _jsx(TextInput, {\n        style: styles.address,\n        value: inputtextob,\n        placeholder: \"comentario 1\",\n        keyboardType: \"numeric\"\n      }), _jsx(AddButton, {\n        onPress: onConfirmAddress,\n        title: \"Confirm address\"\n      })]\n    }) : _jsx(_Fragment, {\n      children: _jsx(View, {\n        style: styles.noLocationContainer,\n        children: _jsx(Text, {\n          children: error\n        })\n      })\n    })]\n  });\n};\nexport default LocationSelector;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"flex-start\"\n  },\n  text: {\n    paddingTop: 20,\n    fontFamily: 'Josefin',\n    fontSize: 18\n  },\n  noLocationContainer: {\n    width: 200,\n    height: 200,\n    borderWidth: 2,\n    borderColor: colors.peach,\n    padding: 10,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  address: {\n    padding: 10,\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","Location","AddButton","usePostUserLocationMutation","useDispatch","useSelector","setUserLocation","colors","MapPreview","google_maps_api_key","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LocationSelector","_ref","navigation","_useState","latitude","longitude","_useState2","_slicedToArray","location","setLocation","_useState3","_useState4","error","setError","_useState5","_useState6","inputtextoa","setInputtextoa","_useState7","_useState8","inputtextob","setInputtextob","_useState9","_useState10","address","setAddress","_useSelector","state","userReducer","value","localId","_usePostUserLocationM","_usePostUserLocationM2","triggerPostAddress","result","dispatch","onConfirmAddress","alert","locationFormatted","inputa","inputb","console","log","goBack","_asyncToGenerator","_yield$Location$reque","requestForegroundPermissionsAsync","status","getCurrentPositionAsync","coords","message","url_reverse_geocode","response","fetch","data","json","results","formatted_address","View","style","styles","container","children","Text","text","TextInput","placeholder","keyboardType","onPress","title","noLocationContainer","StyleSheet","create","flex","alignItems","justifyContent","paddingTop","fontFamily","fontSize","width","height","borderWidth","borderColor","peach","padding"],"sources":["C:/Users/federico.currao/Desktop/OtrosFC/mycar/Where-Is-My-Car---App-Android/src/Screens/LocationSelector.jsx"],"sourcesContent":["import { StyleSheet, Text, TextInput, View } from \"react-native\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport * as Location from \"expo-location\";\r\nimport AddButton from \"../Components/AddButton\";\r\nimport { usePostUserLocationMutation } from \"../Services/shopServices\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { setUserLocation } from \"../features/User/userSlice\";\r\nimport { colors } from \"../Global/Colors\";\r\nimport MapPreview from \"../Components/MapPreview\";\r\nimport { google_maps_api_key } from \"../Database/firebaseConfig\";\r\n\r\nconst LocationSelector = ({ navigation }) => {\r\n\r\n    const [location, setLocation] = useState({ latitude: \"\", longitude: \"\" });\r\n    const [error, setError] = useState(\"\");\r\n    const [inputtextoa, setInputtextoa] = useState(\"\");\r\n    const [inputtextob, setInputtextob] = useState(\"\");\r\n\r\n    const [address, setAddress] = useState(null);\r\n\r\n    const { localId } = useSelector(state => state.userReducer.value)\r\n    const [triggerPostAddress, result] = usePostUserLocationMutation();\r\n    const dispatch = useDispatch();\r\n\r\n    const onConfirmAddress = () => {\r\n        alert(\"Direccion cambiada\")\r\n        const locationFormatted = {\r\n            latitude: location.latitude,\r\n            longitude: location.longitude,\r\n            address: address,\r\n            inputa: inputtextoa,\r\n            inputb: inputtextob,\r\n        }\r\n        console.log(\"location\", locationFormatted)\r\n        dispatch(setUserLocation(locationFormatted))\r\n\r\n        triggerPostAddress({ location: locationFormatted, localId })\r\n        navigation.goBack()\r\n    }\r\n\r\n    //Location requested on mount\r\n    useEffect(() => {\r\n        (async () => {\r\n            try {\r\n                let { status } = await Location.requestForegroundPermissionsAsync();\r\n                if (status !== \"granted\") {\r\n                    setError(\"Permission to access location was denied\");\r\n                    return;\r\n                }\r\n\r\n                let location = await Location.getCurrentPositionAsync({});\r\n                setLocation({\r\n                    latitude: location.coords.latitude,\r\n                    longitude: location.coords.longitude,\r\n                });\r\n\r\n            } catch (error) {\r\n                console.log(error.message);\r\n                setError(error.message)\r\n            }\r\n        })();\r\n    }, []);\r\n\r\n    //Reverse geocoding\r\n    useEffect(() => {\r\n        (async () => {\r\n            try {\r\n                if (location.latitude) {\r\n                    const url_reverse_geocode = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${location.latitude},${location.longitude}&key=${google_maps_api_key}`;\r\n                    const response = await fetch(url_reverse_geocode);\r\n                    const data = await response.json();\r\n                    setAddress(data.results[0].formatted_address);\r\n                }\r\n            } catch (error) {\r\n                setError(error.message);\r\n            }\r\n        })();\r\n    }, [location]);\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <Text\r\n                style={styles.text}\r\n            >My Address</Text>\r\n            {/* Flatlist con las directions */}\r\n            {location ? (\r\n                <>\r\n                    <Text\r\n                        style={styles.text}\r\n                    >Lat: {location.latitude}, long: {location.longitude}.\r\n                    </Text>\r\n                    <MapPreview location={location} />\r\n                    <Text style={styles.address}>\r\n                        Adress: {address}\r\n                    </Text>\r\n                        <TextInput\r\n                            style={styles.address}\r\n                            value={inputtextoa}\r\n                            placeholder=\"comentario 1\"\r\n                            keyboardType=\"numeric\"\r\n                        />\r\n                        <TextInput\r\n                            style={styles.address}\r\n                            value={inputtextob}\r\n                            placeholder=\"comentario 1\"\r\n                            keyboardType=\"numeric\"\r\n                        />\r\n                        <AddButton\r\n                            onPress={onConfirmAddress}\r\n                            title=\"Confirm address\"\r\n                        />\r\n                    </>\r\n                    ) : (\r\n                    <>\r\n                        <View style={styles.noLocationContainer}>\r\n                            <Text>{error}</Text>\r\n                        </View>\r\n                    </>\r\n            )}\r\n                </View>\r\n            );\r\n};\r\n\r\n            export default LocationSelector;\r\n\r\n            const styles = StyleSheet.create({\r\n                container: {\r\n                flex: 1,\r\n            alignItems: \"center\",\r\n            justifyContent: \"flex-start\",\r\n    },\r\n            text: {\r\n                paddingTop: 20,\r\n            fontFamily: 'Josefin',\r\n            fontSize: 18\r\n    },\r\n            noLocationContainer: {\r\n                width: 200,\r\n            height: 200,\r\n            borderWidth: 2,\r\n            borderColor: colors.peach,\r\n            padding: 10,\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n    },\r\n            address: {\r\n                padding: 10,\r\n            // fontFamily: \"Ubuntu\",\r\n            fontSize: 16,\r\n    },\r\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}